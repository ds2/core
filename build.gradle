plugins {
    id 'net.researchgate.release' version '2.4.1'
}

allprojects {
    apply plugin: 'maven'

    group = 'ds2.oss.core'
    version = project.version
}

subprojects {
    apply plugin: 'java'
    def javaVersion = JavaVersion.VERSION_1_8
    sourceCompatibility = javaVersion
    targetCompatibility = javaVersion


    repositories {
        mavenLocal()
        jcenter()
        mavenCentral()

        maven { url "https://commondatastorage.googleapis.com/ds2/mvn/oss/releases" }
        maven { url "https://maven.java.net/content/groups/promoted" }
    }

    configurations.all {
    }
    task checkJavaVersion {
        doLast {
            if (JavaVersion.current() != javaVersion) {
                String message = "ERROR: Java" + javaVersion + " required but " +
                        JavaVersion.current() +
                        " found. Change your JAVA_HOME environment variable."
                throw new IllegalStateException(message)
            }
        }
    }

    tasks.withType(JavaCompile) {
        sourceCompatibility = javaVersion
        targetCompatibility = javaVersion
        options.encoding = 'UTF-8'
        compileJava.dependsOn(checkJavaVersion)
    }


}
