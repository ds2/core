plugins {
    id 'ds2.base' version '0.0.4'
    id 'net.researchgate.release' version '2.6.0'
    id "com.jfrog.bintray" version '1.8.0'
}

apply plugin: 'maven-publish'

base {
    javaVersion = JavaVersion.VERSION_1_8
}


allprojects {
    apply plugin: 'maven'

    repositories {
        mavenLocal()
        jcenter()
        maven { url "https://maven.java.net/content/groups/promoted" }
        mavenCentral()
    }
}

subprojects {
    apply plugin: 'java'

}

publishing {
    repositories {
        maven {
            // change to point to your repo, e.g. http://my.org/repo
            url "$buildDir/repo"
        }
    }
    publications {
        mavenJava(MavenPublication) {
            from components.java
            artifact sourceJar {
                classifier "sources"
            }
        }
    }
}

defaultTasks 'clean', 'build', 'publishToMavenLocal'

release {
    git {
        requireBranch = 'release/0.1'
    }
}

bintray {
    user = 'dstrauss'
    key = System.getenv('BINTRAY_API_KEY')
    pkg {
        repo = 'ds2-oss'
        name = 'Core'
        licenses = ['Apache-2.0']
        vcsUrl = 'https://bitbucket.org/lexxy23/ds2-oss-core.git'
    }
    publications = ['mavenJava']
}

afterReleaseBuild.dependsOn bintrayUpload
